{{ 'section-hero-banner-ja.css' | asset_url | stylesheet_tag }}

{%- if section.settings.slide_height == 'adapt_image' and section.blocks.first.settings.image != blank -%}
  {%- style -%}
    @media screen and (max-width: 749px) {
      #HeroBanner-{{ section.id }}::before,
      #HeroBanner-{{ section.id }} .hero-banner-ja__media::before {
        padding-bottom: {{ 1 | divided_by: section.blocks.first.settings.image.aspect_ratio | times: 100 }}%;
        content: '';
        display: block;
      }
    }

    @media screen and (min-width: 750px) {
      #HeroBanner-{{ section.id }}::before,
      #HeroBanner-{{ section.id }} .hero-banner-ja__media::before {
        padding-bottom: {{ 1 | divided_by: section.blocks.first.settings.image.aspect_ratio | times: 100 }}%;
        content: '';
        display: block;
      }
    }
  {%- endstyle -%}
{%- endif -%}

<slideshow-component
  class="hero-banner-ja"
  role="region"
  aria-roledescription="{{ 'sections.slideshow.carousel' | t }}"
  aria-label="{{ section.settings.accessibility_info | default: 'Hero banner carousel' | escape }}"
>

  <div
    class="hero-banner-ja__slider slider slider--everywhere hero-banner-ja--{{ section.settings.slide_height }}{% if section.blocks.first.settings.image == blank %} hero-banner-ja--placeholder{% endif %}"
    id="HeroBanner-{{ section.id }}"
    aria-live="polite"
    aria-atomic="true"
    data-autoplay="{{ section.settings.auto_rotate }}"
    data-speed="{{ section.settings.change_slides_speed }}"
  >
    {%- for block in section.blocks -%}
      <style>
        #HeroSlide-{{ section.id }}-{{ forloop.index }} .hero-banner-ja__media::after {
          opacity: {{ block.settings.image_overlay_opacity | divided_by: 100.0 }};
        }
      </style>
      <div
        class="hero-banner-ja__slide slider__slide"
        id="HeroSlide-{{ section.id }}-{{ forloop.index }}"
        {{ block.shopify_attributes }}
        role="group"
        aria-roledescription="{{ 'sections.slideshow.slide' | t }}"
        aria-label="{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}"
        tabindex="-1"
      >
        {%- comment -%}Background image{%- endcomment -%}
        <div class="hero-banner-ja__media{% if block.settings.image == blank %} placeholder{% endif %}">
          {%- if block.settings.image -%}
            {%- liquid
              assign height = block.settings.image.width | divided_by: block.settings.image.aspect_ratio | round
              assign sizes = '100vw'
              assign widths = '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840'
              assign fetch_priority = 'auto'
              if section.index == 1
                assign fetch_priority = 'high'
              endif
            -%}
            {%- if forloop.first -%}
              {{
                block.settings.image
                | image_url: width: 3840
                | image_tag: height: height, sizes: sizes, widths: widths, fetchpriority: fetch_priority
              }}
            {%- else -%}
              {{
                block.settings.image
                | image_url: width: 3840
                | image_tag: loading: 'lazy', height: height, sizes: sizes, widths: widths
              }}
            {%- endif -%}
          {%- else -%}
            {{ 'hero-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
          {%- endif -%}
        </div>

        {%- comment -%}Text content{%- endcomment -%}
        <div class="hero-banner-ja__content">
          {%- if block.settings.eyebrow != blank -%}
            <p class="hero-banner-ja__eyebrow">{{ block.settings.eyebrow }}</p>
          {%- endif -%}

          {%- if block.settings.heading != blank -%}
            <h1 class="hero-banner-ja__headline">{{ block.settings.heading }}</h1>
          {%- endif -%}

          {%- if block.settings.subheading != blank -%}
            <p class="hero-banner-ja__subheading">{{ block.settings.subheading }}</p>
          {%- endif -%}

          {%- if block.settings.button_label != blank -%}
            <a
              {% if block.settings.link %}href="{{ block.settings.link }}"{% else %}role="link" aria-disabled="true"{% endif %}
              class="hero-banner-ja__button"
            >
              {{ block.settings.button_label | escape }}
              {% render 'icon-arrow-right' %}
            </a>
          {%- endif -%}
        </div>
      </div>
    {%- endfor -%}
  </div>

  {%- if section.blocks.size > 1 -%}
    <div class="hero-banner-ja__controls">
      <button
        type="button"
        class="hero-banner-ja__control-btn hero-banner-ja__control-btn--prev"
        name="previous"
        aria-label="{{ 'sections.slideshow.previous_slideshow' | t }}"
        aria-controls="HeroBanner-{{ section.id }}"
      >
        <span class="svg-wrapper">
          {{- 'icon-caret.svg' | inline_asset_content -}}
        </span>
      </button>
      <div class="hero-banner-ja__dots slider-buttons">
        {%- for block in section.blocks -%}
          <button
            class="hero-banner-ja__dot slider-counter__link"
            aria-label="{{ 'sections.slideshow.load_slide' | t }} {{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}"
            aria-controls="HeroBanner-{{ section.id }}"
          >
            <span class="visually-hidden">{{ forloop.index }}</span>
          </button>
        {%- endfor -%}
      </div>
      <button
        type="button"
        class="hero-banner-ja__control-btn hero-banner-ja__control-btn--next"
        name="next"
        aria-label="{{ 'sections.slideshow.next_slideshow' | t }}"
        aria-controls="HeroBanner-{{ section.id }}"
      >
        <span class="svg-wrapper">
          {{- 'icon-caret.svg' | inline_asset_content -}}
        </span>
      </button>
    </div>
  {%- endif -%}
</slideshow-component>

{%- if request.design_mode -%}
  <script src="{{ 'theme-editor.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

{% schema %}
{
  "name": "Hero Banner (JA Custom)",
  "tag": "section",
  "class": "section hero-banner-ja-section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "select",
      "id": "slide_height",
      "options": [
        {
          "value": "adapt_image",
          "label": "Adapt to image"
        },
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ],
      "default": "large",
      "label": "Slide height"
    },
    {
      "type": "checkbox",
      "id": "auto_rotate",
      "label": "Auto-rotate slides",
      "default": true
    },
    {
      "type": "range",
      "id": "change_slides_speed",
      "min": 3,
      "max": 9,
      "step": 2,
      "unit": "s",
      "label": "Change slides every",
      "default": 5
    },
    {
      "type": "text",
      "id": "accessibility_info",
      "label": "Slideshow description",
      "info": "Describe the slideshow for screen readers",
      "default": "Hero banner carousel showcasing featured collections"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "limit": 5,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Background image",
          "info": "Recommended: 3840x2160px (16:9 ratio) for best quality"
        },
        {
          "type": "range",
          "id": "image_overlay_opacity",
          "min": 0,
          "max": 100,
          "step": 10,
          "unit": "%",
          "label": "Image overlay opacity",
          "info": "Darken image to improve text readability",
          "default": 20
        },
        {
          "type": "header",
          "content": "Text content"
        },
        {
          "type": "text",
          "id": "eyebrow",
          "label": "Eyebrow text",
          "info": "Small text above headline (e.g., 'SUMMER 2026')",
          "default": "SUMMER 2026"
        },
        {
          "type": "inline_richtext",
          "id": "heading",
          "label": "Headline",
          "info": "Large display text in Lora font. Use <em> for italic text (e.g., <em>Chasing</em> the Sun.)",
          "default": "<em>Chasing</em> the Sun."
        },
        {
          "type": "textarea",
          "id": "subheading",
          "label": "Subheading",
          "info": "Descriptive text below headline",
          "default": "Golden hour essentials. Earrings made for long days and warm nights."
        },
        {
          "type": "header",
          "content": "Button"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button text",
          "default": "SHOP NOW"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Button link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero Banner (JA Custom)",
      "blocks": [
        {
          "type": "slide"
        },
        {
          "type": "slide"
        },
        {
          "type": "slide"
        }
      ]
    }
  ]
}
{% endschema %}
